
-- Follow this 3-step process when adding custom/application specific tables/data

-- Step1: Clean up your tables, if exists
drop view DEV_SUPPLY_CHAIN_VW.ORGANIZATION_MASTER_VW if exists;
drop table DEV_SUPPLY_CHAIN_VW.ORGANIZATION_MASTER if exists;

--Step : Create Organization table
CREATE TABLE DEV_SUPPLY_CHAIN_VW.ORGANIZATION_MASTER
(
  ORG_L4_ID       VARCHAR(250),
  ORG_L4_DESC	  VARCHAR(250),
  ORG_L3_ID		  VARCHAR(250),
  ORG_L3_DESC     VARCHAR(250),
  ORG_L2_ID       VARCHAR(250),
  ORG_L2_DESC	  VARCHAR(250),
  ORG_L1_ID       VARCHAR(250),
  ORG_L1_DESC  	  VARCHAR(250),
  DEALER_CHANNEL  VARCHAR(250),
  SALES_DIRECTOR  VARCHAR(250),
  HEAD_OFFICE	  VARCHAR(250),
  BUSINESS_UNIT	  VARCHAR(250),
  ORG_DISCONTINUED INT,
  ORG_DISCONTINUED_DATE	VARCHAR(10),
  MOD_DT		TIMESTAMP
);

--Step 2 :Create Organization Master View

CREATE VIEW DEV_SUPPLY_CHAIN_VW.ORGANIZATION_MASTER_VW
(
   ORG_L4_ID,
   ORG_L4_DESC,
   ORG_L3_ID,
   ORG_L3_DESC,
   ORG_L2_ID,
   ORG_L2_DESC,
   ORG_L1_ID,
   ORG_L1_DESC,
   DEALER_CHANNEL,
   SALES_DIRECTOR,
   HEAD_OFFICE,
   BUSINESS_UNIT,
   ORG_DISCONTINUED,
   ORG_DISCONTINUED_DATE,
   MOD_DT
)
AS
   SELECT  ORG_L4_ID,
   ORG_L4_DESC,
   ORG_L3_ID,
   ORG_L3_DESC,
   ORG_L2_ID,
   ORG_L2_DESC,
   ORG_L1_ID,
   ORG_L1_DESC,
   DEALER_CHANNEL,
   SALES_DIRECTOR,
   HEAD_OFFICE,
   BUSINESS_UNIT,
   ORG_DISCONTINUED,
   ORG_DISCONTINUED_DATE,
   MOD_DT
   FROM DEV_SUPPLY_CHAIN_VW.ORGANIZATION_MASTER;




