-- Step1: Clean up your tables, if exists
drop view DEV_SUPPLY_CHAIN_VW.GEOGRAPHY_MASTER_VW if exists;
drop table DEV_SUPPLY_CHAIN_VW.GEOGRAPHY_MASTER if exists;

CREATE TABLE DEV_SUPPLY_CHAIN_VW.GEOGRAPHY_MASTER
(
  CUSTOMER_ID           VARCHAR(250),
  CUSTOMER_DESC         VARCHAR(250),
  COUNTRY_ID		    VARCHAR(250),
  COUNTRY_DESC	        VARCHAR(250),
  GROUP_OF_COUNTRY_ID	VARCHAR(250),
  GROUP_OF_COUNTRY_DESC VARCHAR(250),
  WORLD_REGION_ID	    VARCHAR(250),
  WORLD_REGION_DESC     VARCHAR(250),
  ALT_GROUP_OF_COUNTRIES VARCHAR(250),
  FIELD_SALES_REP	     VARCHAR(250),
  CUSTOMER_GROUP         VARCHAR(250),
  CUSTOMER_CLASS         VARCHAR(250),
  CUSTOMER_DISCONTINUED  VARCHAR(1),
  CUSTOMER_DISCONTINUED_DATE VARCHAR(10),
  MOD_DT	TIMESTAMP
);

--Step 2 :Create Geograhy Master View

CREATE VIEW DEV_SUPPLY_CHAIN_VW.GEOGRAPHY_MASTER_VW
(
  CUSTOMER_ID,
  CUSTOMER_DESC,
  COUNTRY_ID,
  COUNTRY_DESC,
  GROUP_OF_COUNTRY_ID,
  GROUP_OF_COUNTRY_DESC,
  WORLD_REGION_ID,
  WORLD_REGION_DESC,
  ALT_GROUP_OF_COUNTRIES,
  FIELD_SALES_REP,
  CUSTOMER_GROUP,
  CUSTOMER_CLASS,
  CUSTOMER_DISCONTINUED,
  CUSTOMER_DISCONTINUED_DATE,
  MOD_DT
)
AS
SELECT
  CUSTOMER_ID,
  CUSTOMER_DESC,
  COUNTRY_ID	,
  COUNTRY_DESC,
  GROUP_OF_COUNTRY_ID,
  GROUP_OF_COUNTRY_DESC,
  WORLD_REGION_ID,
  WORLD_REGION_DESC,
  ALT_GROUP_OF_COUNTRIES,
  FIELD_SALES_REP,
  CUSTOMER_GROUP,
  CUSTOMER_CLASS,
  CUSTOMER_DISCONTINUED,
  CUSTOMER_DISCONTINUED_DATE,
  MOD_DT
  FROM DEV_SUPPLY_CHAIN_VW.GEOGRAPHY_MASTER;


